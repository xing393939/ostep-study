### 整体框架

#### 系统调用
* [操作系统学习（十四） 、中断描述符表和中断描述符](https://www.cnblogs.com/ay-a/p/9191051.html)
* 电脑开机后是实模式，此时可以访问任何内存，通过指令变成保护模式
* 段描述符：8字节，主要包含三个方面，段的基址 + 段的总页数 + 读写权限
* GDT表：Global Descriptor Table，全局描述符表。item称为段描述符。
* LDT表：Local Descriptor Table，局部描述表，每个任务可以有一张。item称为段描述符。
* IDT表：Interrupt Descriptor Table，中断描述符表。可以存放三种类型的门描述符：
  1. 中断门描述符：16位segment selector，32位offset
  1. 陷阱门描述符：16位segment selector，32位offset
  1. 任务门描述符
  1. 最多256个item，每个item固定8字节，寻址 = IDTR + 中断号 * 8，其中的DPL字段标识了特权级别
* 寄存器：
  1. CPL：Current Privilege Level，当前的特权级别（0~3）
  1. GDTR：指向GDT表的位置
  1. LDTR：指向LDT表的位置
  1. IDTR：指向IDT表的位置，48位（其中32位表示LDT表基地址，16位表示LDT表的长度）
  1. 段寄存器：[保护模式 2讲 -段 -段寄存器结构](https://www.cnblogs.com/iBinary/p/13155281.html)
    * CS(代码段)
    * SS(堆栈段)
    * DS(数据段)
    * ES(附加扩展段)
    * FS(分段机制)
    * 段寄存器16位：13位是segment selector，1位是TI（Table Indicator），2位是RPL（Requested Privilege Level）
      * TI=0，找GDT表
      * TI=1，找LDT表
    * [Intel为了保持向后兼容，将段寄存器仍然规定为16位，所以需要借助GDT/LDT表找到基址](https://blog.csdn.net/darmao/article/details/78981649)
* 汇编指令：
  1. 开启A20：<br/>mov dx,0x92<br/> in al,dx<br/> or al,0x02<br/> out dx,al<br/>
  1. 开启保护模式：<br/>cli<br/> mov eax,cr0<br/> or eax,0x01<br/> mov cr0,eax<br/>
  1. LIDT 和 SIDT 分别用于加载和保存IDTR寄存器，CPL=0才能执行
* 通过int 80指令从用户态到用户态的新方案：使用sysenter和和sysexit指令

#### 进程
* 进程调度
* 进程切换

#### 内存
* 分段
  1. 内核空间slab算法
  1. 用户空间伙伴算法
  1. 段分配算法：
    * 最佳适配
    * 最差适配
    * first适配
  1. 段分配算法被分页方案替代
* 分页
  1. 地址转换vpn+offset
  1. 多级页表
  1. 页置换算法：
    * FIFO
    * 随机替换
    * lru
  1. 页载入算法
  1. 脏页刷硬盘



